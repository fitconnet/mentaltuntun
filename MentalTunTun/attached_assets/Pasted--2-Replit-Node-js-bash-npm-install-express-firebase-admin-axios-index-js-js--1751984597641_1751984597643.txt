âœ… 2ë‹¨ê³„: Replitì— Node.js ì„œë²„ êµ¬ì¶•
bash
ë³µì‚¬
í¸ì§‘
npm install express firebase-admin axios
ğŸ“ index.js ì½”ë“œ
js
ë³µì‚¬
í¸ì§‘
const express = require("express");
const admin = require("firebase-admin");
const axios = require("axios");
const app = express();
require("dotenv").config();

admin.initializeApp({
  credential: admin.credential.cert({
    projectId: process.env.FIREBASE_PROJECT_ID,
    clientEmail: process.env.FIREBASE_CLIENT_EMAIL,
    privateKey: process.env.FIREBASE_PRIVATE_KEY.replace(/\\n/g, '\n'),
  }),
});

app.use(express.json());

app.post("/api/firebase-token", async (req, res) => {
  const { provider, token } = req.body;
  let userInfo;

  try {
    if (provider === "kakao") {
      const kakaoRes = await axios.get("https://kapi.kakao.com/v2/user/me", {
        headers: { Authorization: `Bearer ${token}` },
      });
      userInfo = kakaoRes.data;
    } else if (provider === "naver") {
      const naverRes = await axios.get("https://openapi.naver.com/v1/nid/me", {
        headers: { Authorization: `Bearer ${token}` },
      });
      userInfo = naverRes.data.response;
    }

    const uid = `${provider}:${userInfo.id}`;
    const firebaseToken = await admin.auth().createCustomToken(uid, {
      email: userInfo.email || null,
      nickname: userInfo.nickname || null,
    });

    res.json({ firebaseToken });
  } catch (err) {
    console.error(err);
    res.status(500).send("Error creating Firebase token");
  }
});

app.listen(3000, () => console.log("Server running on port 3000"));
âœ… 3ë‹¨ê³„: í”„ë¡ íŠ¸ì—ì„œ ë¡œê·¸ì¸ ì—°ë™
ğŸ”¹ Kakao ì˜ˆì‹œ
html
ë³µì‚¬
í¸ì§‘
<script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
<script>
Kakao.init("ì¹´ì¹´ì˜¤ ìë°”ìŠ¤í¬ë¦½íŠ¸ í‚¤");

function kakaoLogin() {
  Kakao.Auth.login({
    success: function (authObj) {
      fetch("/api/firebase-token", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ provider: "kakao", token: authObj.access_token }),
      })
        .then((res) => res.json())
        .then(({ firebaseToken }) => {
          firebase.auth().signInWithCustomToken(firebaseToken);
        });
    },
  });
}
</script>