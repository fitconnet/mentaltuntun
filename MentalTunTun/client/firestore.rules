rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // 사용자 프로필 (UID 기반 접근 제어)
    match /users/{uid} {
      allow read, write: if request.auth != null && request.auth.uid == uid;
    }
    
    // 감정 기록 (UID 기반 접근 제어)
    match /emotion_logs/{uid}/entries/{entryId} {
      allow read, write: if request.auth != null && request.auth.uid == uid;
    }
    
    // AI 상담 세션 (UID 기반 접근 제어)
    match /ai_sessions/{uid}/sessions/{sessionId} {
      allow read, write: if request.auth != null && request.auth.uid == uid;
    }
    
    // 자아 탐색 기록 (UID 기반 접근 제어)
    match /identity_exploration/{uid}/steps/{stepId} {
      allow read, write: if request.auth != null && request.auth.uid == uid;
    }
    
    // 캘린더 요약 (UID 기반 접근 제어)
    match /calendar_summary/{uid}/months/{monthId} {
      allow read, write: if request.auth != null && request.auth.uid == uid;
    }
    
    // 모든 다른 문서는 접근 금지
    match /{document=**} {
      allow read, write: if false;
    }
  }
}